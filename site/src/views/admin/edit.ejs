<!DOCTYPE html>
<html lang="en">
<!-- -->
<!-- Head -->

<%- include('../partial/head.ejs') %>

<body class="admin create">

    <!--Header-->

    <%- include('./partials/header.ejs')  %>

    <!--Main-->

    <main>

        <h1>Edición del producto</h1>

        <form class="form" action="/admin/edit/<%= products.id %>?_method=PUT" method="POST"
            enctype="multipart/form-data">

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="titulo" name="titulo" value="<%= products.name %>"
                    placeholder="name@example.com">
                <label for="titulo">Nombre del producto</label>
                <% if(locals.errors && errors.titulo){ %>
                <small class="error"> <%= errors.titulo.msg %> </small>
                <% } %>
                <small id="titulosmall"></small>
            </div>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="marca" name="marca" value="<%= locals.userLogged.brand %> "
                    placeholder="name@example.com" readonly>
                <label for="marca">Nombre de la marca</label>
                <small id="marcasmall"></small>
            </div>

            <div class="form-floating">
                <select class="form-select" id="categoria" name="categoria" aria-label="Floating label select example">
                    <% categories.forEach(category => { %>
                    <option <%= products.categoriesId == category.id && 'selected' %> value="<%= category.id %>">
                        <%= category.name %> </option>
                    <% }) %>
                </select>
                <small id="categoriasmall"></small>
                <label for="categoria">Categoria del producto</label>
            </div>

            <div class="form-floating">
                <textarea class="form-control" placeholder="Leave a comment here" id="descripcion"
                    name="descripcion"> <%= products.description %>"</textarea>
                <label for="descripcion">Descripción del producto</label>
                <% if(locals.errors && errors.descripcion){ %>
                <small class="error"> <%= errors.descripcion.msg %> </small>
                <% } %>
                <small id="descripcionsmall"></small>
            </div>
            
            <!--Vista previa de imagenes-->
            
            <section class="img-product">

                <div class="container">
                    <div class="row">
                        <div class="col">
                            <label class="selectImg" for="imagen">
                                <div class="imgHover">
                                    <p class="text-center">Imagen 1:</p>
                                </div>
                                <img id="img-preview" class="img-fluid img-thumbnail imagen-height rounded"
                                    src="/img/products/<%= products.images[0].file ? products.images[0].file : 'default-image.png'%>" alt="">
                            </label>
                            <div class="form-admin__box inactivo">
                                <input class="d-none" id="imagen" type="file" name="imagen"
                                    placeholder="Imagen del Producto" accept=".jpg,.png,.jpeg" multiple>
                                <small id="imagensmall"></small>
                            </div>
                        </div>
                        <!-- 2 -->
                        <div class="col">
                            <label class="selectImg" for="imagen2">
                                <div class="imgHover">
                                    <p class="text-center">Imagen 2:</p>
                                </div>
                                <img id="img-preview2" class="img-fluid img-thumbnail imagen-height rounded"
                                    src="/img/products/<%= products.images[1] ? products.images[1].file : 'default-image.png'%>" alt="">
                            </label>
                            <div class="form-admin__box inactivo">
                                <input class="d-none" id="imagen2" type="file" name="imagen2"
                                    placeholder="Imagen del Producto" accept=".jpg,.png,.jpeg" multiple>
                                <small id="imagensmall"></small>
                            </div>
                        </div>
                        <!-- 3 -->
                        <div class="col">
                            <label class="selectImg" for="imagen3">
                                <div class="imgHover">
                                    <p class="text-center">Imagen 3:</p>
                                </div>
                                <img id="img-preview3" class="img-fluid img-thumbnail imagen-height rounded"
                                    src="/img/products/<%= products.images[2] ? products.images[2].file : 'default-image.png'%>" alt="">
                            </label>
                            <div class="form-admin__box inactivo">
                                <input class="d-none" id="imagen3" type="file" name="imagen3"
                                    placeholder="Imagen del Producto" accept=".jpg,.png,.jpeg" multiple>
                                <small id="imagensmall"></small>
                            </div>
                        </div>
                        <!-- 4 -->
                        <div class="col">
                            <label class="selectImg" for="imagen4">
                                <div class="imgHover">
                                    <p class="text-center">Imagen 4:</p>
                                </div>
                                <img id="img-preview4" class="img-fluid img-thumbnail imagen-height rounded"
                                    src="/img/products/<%= products.images[3] ? products.images[3].file : 'default-image.png'%>" alt="">
                            </label>
                            <div class="form-admin__box inactivo">
                                <input class="d-none" id="imagen4" type="file" name="imagen4"
                                    placeholder="Imagen del Producto" accept=".jpg,.png,.jpeg" multiple>
                                <small id="imagensmall"></small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <div class="input-group mb-3">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control" placeholder="Precio del producto" id="precio" name="precio"
                    value="<%=products.price%>">
                <span class="input-group-text">.00</span>
                <% if(locals.errors && errors.precio){ %>
                <small class="error"> <%= errors.precio.msg %> </small>
                <% } %>
                <small id="preciosmall"></small>
            </div>

            <div class="boton">
                <button type="submit" class="btn btn-primary" id="enviardatos">Enviar datos</button>
                <button type="reset" class="btn btn-secondary">Borrar datos</button>
            </div>

        </form>

    </main>

    <!-- Footer -->
    <%- include('../partial/footer.ejs') %>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous">
    </script>
    <script src="/javascript/validaciones/editproduct.js"></script>
    <script src="/javascript/images.js"></script>
</body>

</html>